# 更新日志

## [Unreleased]

### 修复 (Fixes)

- **日志监控**: 修复日志监控界面不会自动刷新的问题 (2026-02-12 19:30:00)
  - 后端添加 `WatcherHandle` 结构体用于管理 watcher 任务生命周期
  - 实现真正的 `stop_log_stream` 功能，支持取消正在运行的监控任务
  - 添加轮询机制作为 notify watcher 的备选方案（每 500ms 检查一次）
  - 前端修复页面切换后事件监听器恢复逻辑
  - 添加组件卸载时的事件监听器清理

- **日志筛选**: 添加 DEBUG 级别的日志筛选支持，调整按钮顺序为 INFO-DEBUG-WARN-ERROR (2026-02-12 19:30:00)
  - 移除手动刷新按钮，日志监控已实现自动更新

### 新增 (Features)

- **仪表盘**: 添加日志统计卡片，与 CPU 监控、内存监控并列显示 (2026-02-12 19:30:00)
  - 后端添加 `get_log_statistics` API 用于获取日志统计信息
  - 仪表盘新增日志统计卡片，显示各级别日志数量和占比
  - 修复日志级别匹配逻辑，使用更灵活的大写匹配方式

- **仪表盘**: 添加磁盘使用率监控 (2026-02-12 19:30:00)
  - 后端 `get_system_info` API 新增磁盘使用情况
  - 仪表盘性能监控卡片新增磁盘使用率显示
  - 使用平台特定实现：macOS/Linux 使用 df 命令，Windows 待实现
  - 显示总空间、已用空间、可用空间和使用百分比
  - 进度条可视化磁盘使用情况
  - 与 CPU、内存监控并列显示，统一紫色主题

- **网络监控**: 实现网络监控折线图 (2026-02-12 19:30:00)
  - 安装 recharts 图表库用于数据可视化
  - 创建 NetworkMonitor 组件显示上行/下行带宽实时折线图
  - 使用 SVG 绘制平滑折线，支持自动缩放
  - 显示最近60秒的网络数据，每秒更新
  - 添加实时速度显示（B/s, KB/s, MB/s）
  - 后端添加网络监控 API（network.rs）
  - 使用真实网络流量数据（macOS 使用 netstat，Linux 读取 /proc/net/dev）
  - 实现跨平台支持：macOS、Linux、Windows
  - 通过计算差值获取每秒实际网络速度
  - 前端通过 networkApi 获取真实统计数据
  - 修复所有 Rust 编译错误，代码编译通过且无警告
  - 优化类型转换，使用整数运算避免浮点精度问题
  - 移除冗余的状态管理代码，简化 main.rs 架构

### 界面优化 (UI/UX)

- **侧边栏**: 添加 nanobot 控制按钮 (2026-02-12 19:30:00)
  - 将"启动/停止"和"重启"按钮移至侧边栏底部
  - 按钮状态实时反映 nanobot 运行状态
  - 鼠标悬停时显示功能提示（"启动 nanobot"、"停止 nanobot"、"重启 nanobot"）
  - 启动/停止按钮根据状态显示绿色（停止）或红色（运行）配色
  - 重启按钮仅在 nanobot 运行时可用
  - 从仪表盘"快速操作"区域移除相关按钮，仅保留下载和初始化功能

- **仪表盘**: 优化配置卡片布局 (2026-02-12 19:30:00)
  - 将 LLM Provider、Agent配置、消息渠道三个卡片从"当前配置概览"容器中独立出来
  - 统一卡片样式，使用与其他卡片一致的 `card-hover` 效果
  - 改善整体视觉一致性

- **仪表盘**: 重构系统监控区域布局 (2026-02-12 19:30:00)
  - 移除"快速操作"卡片，控制按钮已移至侧边栏
  - 将 CPU 监控和内存监控合并为左侧的"性能监控"卡片
  - 中间位置添加"网络监控折线图"占位卡片（显示"即将推出"）
  - 右侧保留日志统计卡片
  - 调整为3列网格布局（性能监控 | 网络监控 | 日志统计）
  - 移除不再需要的导入和状态（Download、Rocket、RefreshCw、loading、toast）

- **仪表盘**: 优化配置卡片显示 (2026-02-12 19:30:00)
  - LLM Provider 卡片支持显示最多4个提供商（原3个）
  - Agent 配置卡片新增"最大工具迭代次数"字段显示
  - 调整 Agent 配置卡片字段顺序：模型 → 最大 Token → 最大工具迭代次数 → 温度
  - 更新 Config 接口类型定义以支持 max_tool_iterations 字段